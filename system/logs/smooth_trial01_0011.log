==================================================
goal = smooth_trial01_0011
device = cuda
device_id = 0
dataset = Cifar10
num_classes = 10
model = CNN
batch_size = 64
local_learning_rate = 0.01
learning_rate_decay = True
learning_rate_decay_gamma = 0.98
global_rounds = 500
top_cnt = 100
local_epochs = 5
algorithm = FedEntPlusSmooth
join_ratio = 0.1
random_join_ratio = False
num_clients = 100
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.9
kl_weight = 0.0
buffer_size = 0
dp_epsilon = 0.0
H_min = None
alpha_vp = 0.0
enable_dynamic_param = False
log_fedent = False
log_filename = None
dynamic_config_path = /home/john/PFLlib/system/auto_configs/smooth_trial01_0011.json
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 0.1 / 100
Finished creating server and clients.

--- Round 0/500 ---
Averaged Train Loss: 2.3038
Averaged Test Accuracy: 0.0928
Averaged Test AUC: 0.4894
Std Test Accuracy: 0.1434
Std Test AUC: 0.2233

--- Round 1/500 ---
Averaged Train Loss: 2.3029
Averaged Test Accuracy: 0.1020
Averaged Test AUC: 0.4983
Std Test Accuracy: 0.1837
Std Test AUC: 0.2427

--- Round 2/500 ---
Averaged Train Loss: 2.2981
Averaged Test Accuracy: 0.1215
Averaged Test AUC: 0.5247
Std Test Accuracy: 0.2105
Std Test AUC: 0.2199

--- Round 3/500 ---
Averaged Train Loss: 2.3116
Averaged Test Accuracy: 0.1499
Averaged Test AUC: 0.5311
Std Test Accuracy: 0.2059
Std Test AUC: 0.2489

--- Round 4/500 ---
Averaged Train Loss: 2.2917
Averaged Test Accuracy: 0.1412
Averaged Test AUC: 0.5506
Std Test Accuracy: 0.2014
Std Test AUC: 0.2263

--- Round 5/500 ---
Traceback (most recent call last):
  File "/home/john/PFLlib/system/main.py", line 565, in <module>
    run(args)
  File "/home/john/PFLlib/system/main.py", line 384, in run
    server.train()
  File "/home/john/PFLlib/system/flcore/servers/serverfedentplus_smooth.py", line 378, in train
    self.evaluate()
  File "/home/john/PFLlib/system/flcore/servers/serverbase.py", line 229, in evaluate
    stats_train = self.train_metrics()
                  ^^^^^^^^^^^^^^^^^^^^
  File "/home/john/PFLlib/system/flcore/servers/serverbase.py", line 218, in train_metrics
    cl, ns = c.train_metrics()
             ^^^^^^^^^^^^^^^^^
  File "/home/john/PFLlib/system/flcore/clients/clientbase.py", line 122, in train_metrics
    trainloader = self.load_train_data()
                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/PFLlib/system/flcore/clients/clientbase.py", line 57, in load_train_data
    train_data = read_client_data(self.dataset, self.id, is_train=True)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/PFLlib/system/utils/data_utils.py", line 33, in read_client_data
    train_data = read_data(dataset, idx, is_train)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/PFLlib/system/utils/data_utils.py", line 12, in read_data
    train_data = np.load(f, allow_pickle=True)['data'].tolist()
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/john/miniconda3/envs/pfllib/lib/python3.11/site-packages/numpy/lib/npyio.py", line 256, in __getitem__
    return format.read_array(bytes,
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/miniconda3/envs/pfllib/lib/python3.11/site-packages/numpy/lib/format.py", line 800, in read_array
    array = pickle.load(fp, **pickle_kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/john/miniconda3/envs/pfllib/lib/python3.11/zipfile.py", line 966, in read
    data = self._read1(n)
           ^^^^^^^^^^^^^^
  File "/home/john/miniconda3/envs/pfllib/lib/python3.11/zipfile.py", line 1056, in _read1
    self._update_crc(data)
  File "/home/john/miniconda3/envs/pfllib/lib/python3.11/zipfile.py", line 981, in _update_crc
    self._running_crc = crc32(newdata, self._running_crc)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
